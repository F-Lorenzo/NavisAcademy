import{a as i,c as Q,x as U,e as ce,T as M,E as de,r as p,j as t,F as J,L as V,D as z,K as ne,Q as re,g as oe,C as fe,k as ue,I as ae,A as me,U as Ce,u as Ne}from"./index.07d71d12.js";import{T as he}from"./TimePicker.07d6dd4b.js";import{C as De}from"./CountryDropdown.0c4f9d29.js";const ye=({info:e})=>i("div",{className:"moreInfo-container",children:[i("ul",{children:[i("li",{children:["Numero de contacto: ",e.phoneNumber]}),i("li",{children:["Pais: ",e.country]}),i("li",{children:["Ciudad: ",e.city]})]}),e.role==="teacher"?i("ul",{children:[i("li",{children:["Total de clases impartidas: ",e.totalClasses]}),i("li",{children:["Clases impartidas este mes: ",e.thisMonthClasses]}),i("li",{children:["Clases impartidas el mes pasado: ",e.lastMonthClasses]}),i("li",{children:["Clases ausente: ",e.absentedClasses]})]}):i("ul",{children:[i("li",{children:["Clases disponibles: ",e.remainingClases]}),i("li",{children:["Clases completadas: ",e.completedClases]}),i("li",{children:["Clases ausente: ",e.absentedClases]}),i("li",{children:["Total de clases compradas: ",e.totalClasses]}),i("li",{children:["Duracion de la clase: ",e.durationClass,"min"]}),i("li",{children:["Profesor: ",e.teacherName]})]})]}),Se=async(e,s)=>{const r=Q(),C=U(r,`Users/${e.uid}/myClasses/${e.myClassesId}`),m=(await ce(C)).data(),o=U(r,`Users/${e.teacherUid}`);let A=(await ce(o)).data().disponibility;const P=m.durationClass;let k=0;const D={teacher:"unasigned",teacherName:"",teacherUid:"",teacherPhoneNumber:""},q={teacherEmail:"",teacherLastName:""};switch(P){case 30:k=2;break;case 50:k=3;break}m.userWeek.map(v=>{const R=v.timeDate.toDate(),K=R.getUTCHours().toString().padStart(2,"0"),n=R.getUTCMinutes().toString().padStart(2,"0"),l=`${K}:${n}`;let c=A[v.day];c[l]=!0;let u=l;for(let f=0;f<k;f++){let[d,a]=u.split(":");a=Number(a)+15,a>=60&&(a=a-60,d=Number(d)+1,d<10&&(d="0"+d),a<10&&(a="0"+a)),u=`${d}:${a}`,c[u]=!0}});const W=U(r,`Users/${e.uid}`);await M(W,{...D}),await M(C,{...q,...D}),await M(o,{disponibility:A});const L=U(r,`Classes/${e.myClassesId}`);return await M(L,{...q,...D}),await de(U(r,`Users/${e.teacherUid}/myStudents/${e.uid}`)),await de(U(r,`Users/${e.teacherUid}/mySchedule/${e.uid}`)),swal("OK","El alumno quedo sin profesor, asignale uno en ASIGNAR PROFESOR","success"),s(!1)},ge=({userData:e})=>{const[s,r]=p.exports.useState(!1),[C,N]=p.exports.useState(!1),[m,o]=p.exports.useState(!1),S=()=>{r(!s)},w=A=>{N(A)},I=()=>{o(!m),w(!0),Se(e,w)};return t(J,{children:C?t(V,{}):t("div",{className:"userCardProfile-container",children:i("div",{className:"userCardProfile-header_container",children:[i("div",{className:"userCardProfile-header",children:[t("div",{className:"userCardProfile-avatar",children:t("i",{className:"fa-solid fa-user fa-2x"})}),i("div",{className:"userCardProfile-info",children:[i("p",{children:[e.name," ",e.lastName]}),t("span",{children:e.role==="teacher"?"Profesor":"Alumno"}),t("span",{children:e.email})]}),t("button",{className:s?"userCardProfile-button active":"userCardProfile-button",onClick:S,children:"MAS INFORMACION"}),!m&&e.role==="alumn"&&e.teacher==="assigned"&&t("button",{className:"userCardProfile-button",onClick:I,children:"CAMBIAR PROFESOR"})]}),s&&t(ye,{info:e})]})})})},be=({users:e=[]})=>e.map(s=>t(ge,{userData:s},s.id)),pe=({roleNeeded:e})=>{const s=Q(),[r,C]=p.exports.useState(!0),[N,m]=p.exports.useState([]);return p.exports.useEffect(()=>{const o=z(s,"Users"),S=ne(o,re("role","==",`${e}`));oe(S).then(w=>m(w.docs.map(I=>({...I.data()})))),C(!1)},[]),t(J,{children:r?t(V,{}):t("div",{children:t(be,{users:N})})})},ve=({date:e,teacher:s,selected:r})=>{const[C,N]=p.exports.useState(!1),m=fe(),o={teacher:"assigned",condition:"succes",teacherEmail:s.email,teacherUid:s.id,teacherName:s.name,teacherLastName:s.lastName,teacherPhoneNumber:s.phoneNumber},S={studentEmail:e.studentEmail,studentUid:e.studentUid,studentName:e.studentName,studentLastName:e.studentLastName,studentPhoneNumber:e.studentPhoneNumber,remainingClases:e.remainingClases,classWeek:e.userWeek},w={textNotification:"Felicitaciones, tu peticion de clases fue aceptada, ya te asignamos un profesor",notificationType:"Notificacion",checked:!1},I={textNotification:`Se te asigno un nuevo alumno, su nombre es ${e.studentName} ${e.studentLastName}`,notificationType:"Notificacion",checked:!1},A=[],P=[],k=[],D=s.disponibility,q=e.durationClass;let W=D,L=!0,v=0,x=0;switch(q){case 30:v=2;break;case 50:v=3;break}const R=()=>{L=!L};e.userWeek.map(n=>{const l=s.weekDisponibility.filter(c=>c.day===n.day);A.push(...l)}),e.userWeek.length!=A.length?R():e.userWeek.map((n,l)=>{!(n.timeDate>=A[l].timeStartDate&&n.timeDate<A[l].timeEndDate)&&R()});function O(n,l,c){let u=!0;for(let f=0;f<l;f++){let[d,a]=n.split(":");if(a=Number(a)+15,a>=60&&(a=a-60,d=Number(d)+1,d<10&&(d="0"+d),a<10&&(a="0"+a),d===24&&(d="00")),n=`${d}:${a}`,u=c[n],!u)break}return u}L&&e.userWeek.map((n,l)=>{const u=n.timeDate.toDate(),d=u.getUTCHours().toString().padStart(2,"0"),y=u.getUTCMinutes().toString().padStart(2,"0"),g=`${d}:${y}`;n.day==="lunes"&&D.lunes[g]&&O(g,v,D.lunes)&&x++,n.day==="martes"&&D.martes[g]&&O(g,v,D.martes)&&x++,n.day==="miercoles"&&D.miercoles[g]&&O(g,v,D.miercoles)&&x++,n.day==="jueves"&&D.jueves[g]&&O(g,v,D.jueves)&&x++,n.day==="viernes"&&D.viernes[g]&&O(g,v,D.viernes)&&x++,n.day==="sabado"&&D.sabado[g]&&O(g,v,D.sabado)&&x++,n.day==="domingo"&&D.domingo[g]&&O(g,v,D.domingo)&&x++}),L&&x!=e.userWeek.length&&R();const K=()=>{let n=new Date;const l=(h,b)=>{h.setDate(h.getDate()+b)};let c=0,u=1,f=2,d=3,a=4,y=5,g=6;switch(n.getDay()){case 0:l(n,0);break;case 1:l(n,-1);break;case 2:l(n,-2);break;case 3:l(n,-3);break;case 4:l(n,-4);break;case 5:l(n,-5);break;case 6:l(n,-6);break}const T=(h,b,Z,le)=>{l(n,b);const ee=h.toDate(),ie=n.getDate(),te=n.getMonth(),_=n.getFullYear(),G=ee.getHours(),j=ee.getMinutes();let se=new Date(_,te,ie,G,j),$=new Date(_,te,ie,G,j);$.setMinutes($.getMinutes()+le);const E={date:se,dateEnd:$,time:h,condition:"pending",linkToClass:"",teacherCalification:"",studentCalification:"",studentAssist:!1,reprogramed:!1,durationClass:e.durationClass,classNumber:Z,calificationOfClass:"",studentName:e.studentName,studentLastName:e.studentLastName,studentUid:e.studentUid,studentEmail:e.studentEmail,teacherName:s.name,teacherLastName:s.lastName,teacherUid:s.id};P.push(E),k.push(E),l(n,-b)},X=(h,b)=>{h.day==="domingo"&&T(h.timeDate,c,b,e.durationClass),h.day==="lunes"&&T(h.timeDate,u,b,e.durationClass),h.day==="martes"&&T(h.timeDate,f,b,e.durationClass),h.day==="miercoles"&&T(h.timeDate,d,b,e.durationClass),h.day==="jueves"&&T(h.timeDate,a,b,e.durationClass),h.day==="viernes"&&T(h.timeDate,y,b,e.durationClass),h.day==="sabado"&&T(h.timeDate,g,b,e.durationClass)};let F=0;l(n,7);for(let h=0;h<e.remainingClases;h++)F===e.userWeek.length&&(F=0,l(n,7)),X(e.userWeek[F],h),F++;e.userWeek.map(h=>{const Z=h.timeDate.toDate(),ee=Z.getUTCHours().toString().padStart(2,"0"),te=Z.getUTCMinutes().toString().padStart(2,"0"),_=`${ee}:${te}`;let G=W[h.day];G[_]=!1;let j=_;for(let se=0;se<v;se++){let[$,E]=j.split(":");E=Number(E)+15,E>=60&&(E=E-60,$=Number($)+1,$<10&&($="0"+$),E<10&&(E="0"+E)),j=`${$}:${E}`,G[j]=!1}})},Y=async n=>{N(!0),r(!0),K(),n.preventDefault();try{const l=Q(),c=U(l,`Classes/${e.id}`);await M(c,{...o});const u=U(l,`Users/${s.id}`);await M(u,{disponibility:W,notifications:ue(1)});const f=U(l,`Users/${s.id}/myStudents/${e.studentUid}`);await ae(f,{...S});const d=U(l,`Users/${s.id}/mySchedule/${e.studentUid}`);await ae(d,{...P});const a=U(l,`Users/${e.studentUid}`);await M(a,{teacher:"assigned",teacherName:`${s.name} ${s.lastName}`,teacherPhoneNumber:s.phoneNumber,teacherUid:s.id,notifications:ue(1),newPurchasedClasses:0});const y=U(l,`Users/${e.studentUid}/myClasses/${e.id}`);await M(y,{...o});const g=U(l,`Users/${e.studentUid}/mySchedule/${e.id}`);await ae(g,{...k});const B=z(l,`Users/${e.studentUid}/myNotifications`);await me(B,{...w,timeStamp:m});const T=z(l,`Users/${s.id}/myNotifications`);await me(T,{...I,timeStamp:m}),N(!1),swal("OK","Se asigno el profesor al alumno","success")}catch(l){swal("UPS!",`${l.message}`,"error"),N(!1)}};if(C)return t(V,{});if(L)return t("div",{className:"userCardProfile-container",children:t("div",{className:"userCardProfile-header_container",children:i("div",{className:"userCardProfile-header",children:[t("div",{className:"userCardProfile-avatar",children:t("i",{className:"fa-solid fa-user fa-2x"})}),i("div",{className:"userCardProfile-info",children:[i("p",{children:["Profesor: ",s.name," ",s.lastName]}),i("span",{children:["Email: ",s.email]})]}),C?t(V,{}):t("button",{className:"userCardProfile-button",onClick:Y,children:"ASIGNAR PROFESOR"})]})})})},Te=({date:e,teachers:s=[],onChange:r})=>s.map(C=>t(ve,{date:e,teacher:C,selected:r},C.id)),Ue=({info:e,teachersList:s})=>{const[r,C]=p.exports.useState(!1),[N,m]=p.exports.useState(!1),o=()=>{!r&&swal("OK","Selecciona un profesor de la lista","success"),C(!r)},S=w=>{m(w)};return t("div",{className:"",children:i("div",{className:"userCardProfile-container",children:[t("div",{className:"userCardProfile-header_container",children:i("div",{className:"userCardProfile-header",children:[t("div",{className:"userCardProfile-avatar",children:t("i",{className:"fa-solid fa-user fa-2x"})}),i("div",{className:"userCardProfile-info",children:[i("p",{children:[e.studentName," ",e.studentLastName]}),t("span",{children:"Alumno"})]}),t("button",{className:r?"userCardProfile-button active":"userCardProfile-button",onClick:o,children:"LISTAR PROFESORES DISPONIBLES"})]})}),t("div",{className:"teacherListed-container",children:!N&&r&&t(Te,{date:e,teachers:s,onChange:S})})]})})},we=({classDate:e=[],teachers:s=[]})=>e.map(r=>t(Ue,{info:r,teachersList:s},r.id)),Ae=()=>{const[e,s]=p.exports.useState([]),[r,C]=p.exports.useState([]),[N,m]=p.exports.useState(!0);return p.exports.useEffect(()=>{const o=Q(),S=z(o,"Classes"),w=ne(S,re("teacher","==","unasigned"));oe(w).then(P=>s(P.docs.map(k=>({id:k.id,...k.data()}))));const I=z(o,"Users"),A=ne(I,re("role","==","teacher"));oe(A).then(P=>C(P.docs.map(k=>({id:k.id,...k.data()})))),m(!1)},[]),t(J,{children:N?t(V,{}):t("div",{children:t(we,{classDate:e,teachers:r})})})},ke=[{field:"Nombre",inNameId:"name",inType:"text"},{field:"Apellido",inNameId:"lastName",inType:"text"},{field:"Contrase\xF1a",inNameId:"password",inType:"password"},{field:"Email",inNameId:"email",inType:"email"},{field:"Numero De Contacto",inNameId:"phoneNumber",inType:"tel"},{field:"Ciudad",inNameId:"city",inType:"text"}];const H=[{"00:00":!0,"00:15":!0,"00:30":!0,"00:45":!0,"01:00":!0,"01:15":!0,"01:30":!0,"01:45":!0,"02:00":!0,"02:15":!0,"02:30":!0,"02:45":!0,"03:00":!0,"03:15":!0,"03:30":!0,"03:45":!0,"04:00":!0,"04:15":!0,"04:30":!0,"04:45":!0,"05:00":!0,"05:15":!0,"05:30":!0,"05:45":!0,"06:00":!0,"06:15":!0,"06:30":!0,"06:45":!0,"07:00":!0,"07:15":!0,"07:30":!0,"07:45":!0,"08:00":!0,"08:15":!0,"08:30":!0,"08:45":!0,"09:00":!0,"09:15":!0,"09:30":!0,"09:45":!0,"10:00":!0,"10:15":!0,"10:30":!0,"10:45":!0,"11:00":!0,"11:15":!0,"11:30":!0,"11:45":!0,"12:00":!0,"12:15":!0,"12:30":!0,"12:45":!0,"13:00":!0,"13:15":!0,"13:30":!0,"13:45":!0,"14:00":!0,"14:15":!0,"14:30":!0,"14:45":!0,"15:00":!0,"15:15":!0,"15:30":!0,"15:45":!0,"16:00":!0,"16:15":!0,"16:30":!0,"16:45":!0,"17:00":!0,"17:15":!0,"17:30":!0,"17:45":!0,"18:00":!0,"18:15":!0,"18:30":!0,"18:45":!0,"19:00":!0,"19:15":!0,"19:30":!0,"19:45":!0,"20:00":!0,"20:15":!0,"20:30":!0,"20:45":!0,"21:00":!0,"21:15":!0,"21:30":!0,"21:45":!0,"22:00":!0,"22:15":!0,"22:30":!0,"22:45":!0,"23:00":!0,"23:15":!0,"23:30":!0,"23:45":!0}],Ee=({teacherForm:e,country:s})=>{const{createUser:r}=Ce();p.exports.useState(!1);const C=Ne(),N=["lunes","martes","miercoles","jueves","viernes","sabado","domingo"],[m,o]=p.exports.useState([]),[S,w]=p.exports.useState(...H),[I,A]=p.exports.useState(...H),[P,k]=p.exports.useState(...H),[D,q]=p.exports.useState(...H),[W,L]=p.exports.useState(...H),[v,x]=p.exports.useState(...H),[R,O]=p.exports.useState(...H),K=c=>{let u=m.filter(y=>y.day===c.id),f=u[0].timeEnd,d=u[0].timeEndDate,a=m.filter(y=>y.day!=c.id);u={day:c.id,timeStart:c.timeString,timeEnd:f,timeStartDate:c.timeDate,timeEndDate:d},a.push(u),o(a)},Y=c=>{let u=m.filter(y=>y.day===c.id),f=u[0].timeStart,d=u[0].timeStartDate,a=m.filter(y=>y.day!=c.id);u={day:c.id,timeStart:f,timeEnd:c.timeString,timeEndDate:c.timeDate,timeStartDate:d},a.push(u),o(a)},n=async()=>{const u={...e,weekDisponibility:m,disponibility:{lunes:S,martes:I,miercoles:P,jueves:D,viernes:W,sabado:v,domingo:R},country:s};try{const f=await r(e.email,e.password).then(y=>y),d=Q(),a=U(d,`Users/${f.user.uid}`);await ae(a,{...u}),swal("OK","Nuevo Profesor Creado","success"),C("/account")}catch(f){swal("UPS!",`${f.message}`,"error")}},l=()=>{let c=!(!e.name||e.name.length<4),u=!(!e.lastName||e.lastName.length<4),f=!(!e.password||e.password.length<9),d=!(!e.email||e.email<12);c?c=!0:swal("CUIDADO!","El nombre debe tener al menos 4 caracteres","error"),u?u=!0:swal("CUIDADO!","El apellido debe tener al menos 4 caracteres","error"),f?f=!0:swal("CUIDADO!","La contrase\xF1a debe tener al menos 9 caracteres","error"),d?d=!0:swal("CUIDADO!","Ingrese una direccion de email valida","error");let a=!1,y=0;m.length===0?swal("CUIDADO!","Debes seleccionar al menos un dia y un horario","error"):m.map(B=>{let T=!1;if(B.timeStartDate&&B.timeEndDate){let X=B.timeStartDate,F=!isNaN(X.getTime()),h=B.timeEndDate,b=!isNaN(h.getTime());(!F||!b)&&swal("CUIDADO!","Debes seleccionar un horario","error"),T=F&&b,T&&X>=h&&swal("CUIDADO!","El horario de inicio debe ser menor al de finalizacion","error")&&(T=!T)}else swal("CUIDADO!","Debes seleccionar un horario","error");T&&y++}),a=(y===m.length)>0,!a&&swal("CUIDADO!","Debes seleccionar un horario","error"),c&&u&&f&&d&&a&&n()};return t(J,{children:i("div",{className:"teacherDisponibility-conteiner",children:[t("h5",{children:"Selecciona los dias y el horario de disponibilidad del docente"}),t("ul",{className:"teacherDisponibility-day-list",children:N.map((c,u)=>{const[f,d]=p.exports.useState(!1);return i("div",{className:"teacherDisponibility-day-time-button",children:[t("li",{className:f?"teacherDisponibility-day-button clicked":"teacherDisponibility-day-button",onClick:()=>{let a=m;f?a=a.filter(y=>y.day!=c):a.push({day:c,timeStart:void 0,timeEnd:void 0,timeStartDate:void 0,timeEndDate:void 0}),d(!f),o(a)},children:c}),f&&i("div",{className:"time-selector",children:[i("li",{children:["Horario de inicio :",t(he,{id:c,name:"timeStart",onChange:K})]}),i("li",{children:["Horario de finalizacion :",t(he,{id:c,name:"timeEnd",onChange:Y})]})]})]},u)})}),t("button",{className:"teacherDisponibility-continue-button",onClick:l,children:"CREAR CUENTA DE PROFESOR"})]})})};const Ie=()=>{const[e,s]=p.exports.useState(),[r,C]=p.exports.useState({role:"teacher",totalClasses:0,thisMonthClasses:0,lastMonthClasses:0,absentedClases:0}),N=o=>{C({...r,[o.target.name]:o.target.value})},m=o=>{s(o)};return t(J,{children:i("div",{className:"createTeacher-container",children:[t("div",{children:i("form",{className:"createTeacher__form",children:[ke.map((o,S)=>i("div",{children:[i("label",{htmlFor:o.inNameId,children:[o.field," :"]}),t("input",{type:o.inType,id:o.inNameId,name:o.inNameId,value:r[o.inNameId]||"",onChange:N})]},S)),t(De,{selected:m})]})}),t(Ee,{teacherForm:r,country:e})]})})},Oe=()=>{const[e,s]=p.exports.useState(!1),[r,C]=p.exports.useState(!1),[N,m]=p.exports.useState(!1),[o,S]=p.exports.useState(!1);return t("div",{className:"",children:i("div",{className:"",children:[t("h5",{children:"PANEL DE ADMINISTRADOR"}),i("div",{className:"panelButtonContainer",children:[t("button",{className:e?"panelButton active":"panelButton",onClick:()=>{r&&C(!1),N&&m(!1),o&&S(!1),!e&&swal("Bienvenido","Aqui podras crear cuentas de profesores","success"),s(!e)},children:"CREAR CUENTA DE PROFESOR"}),t("button",{className:r?"panelButton active":"panelButton",onClick:()=>{e&&s(!1),N&&m(!1),o&&S(!1),!r&&swal("Bienvenido","Aqui veras una lista de profesores registrados","success"),C(!r)},children:"LISTAR PROFESORES"}),t("button",{className:N?"panelButton active":"panelButton",onClick:()=>{e&&s(!1),r&&C(!1),o&&S(!1),!N&&swal("Bienvenido","Aqui veras una lista de alumnos registrados","success"),m(!N)},children:"LISTAR ALUMNOS"}),t("button",{className:o?"panelButton active":"panelButton",onClick:()=>{e&&s(!1),r&&C(!1),N&&m(!1),!o&&swal("Bienvenido","Aqui veras los alumnos que no tienen un profesor asignado y podras asignarles uno","success"),S(!o)},children:"ASIGNAR PROFESOR"})]}),i("div",{children:[e&&t(Ie,{}),r&&t(pe,{roleNeeded:"teacher"}),N&&t(pe,{roleNeeded:"alumn"}),o&&t(Ae,{})]})]})})};export{Oe as default};
