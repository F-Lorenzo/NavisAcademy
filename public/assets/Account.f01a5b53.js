import{a as d,j as e,U as P,d as I,r as S,L as x,c as _,x as m,T as h,D as A,g as T,e as L,u as k}from"./index.f321a84a.js";const M=({userInfo:r,role:l,toggle:t})=>d("div",{className:"asideProfile-container",children:[e("div",{className:"userCard-header_container",children:d("div",{className:"userCard-header",children:[e("div",{className:"user-avatar",children:e("i",{className:"fa-solid fa-user fa-3x"})}),d("div",{className:"userMain-info",children:[d("p",{children:[r.name," ",r.lastName]}),e("span",{children:l==="admin"?"Administrador":l==="alumn"?"Estudiante":"Profesor"})]})]})}),e("div",{className:"userCard-body",children:d("div",{className:"userCard-body-input",children:[e("span",{className:"userCard-body-input_title",children:"Email:"}),e("span",{className:"userCard-body-input_content",children:r.email})]})}),e("div",{className:"userCard-body",children:d("div",{className:"userCard-body-input",children:[e("span",{className:"userCard-body-input_title",children:"Pa\xEDs:"}),e("span",{className:"userCard-body-input_content",children:r.country})]})}),e("div",{className:"userCard-body",children:d("div",{className:"userCard-body-input",children:[e("span",{className:"userCard-body-input_title",children:"Ciudad:"}),e("span",{className:"userCard-body-input_content",children:r.city})]})}),e("div",{className:"userCard-body",children:d("div",{className:"userCard-body-input",children:[e("span",{className:"userCard-body-input_title",children:"N\xFAmero de contacto:"}),e("span",{className:"userCard-body-input_content",children:r.phoneNumber})]})}),e("div",{className:"userCard-footer",children:e("button",{className:"userCard-button",onClick:()=>{t()},children:"Editar Informaci\xF3n"})})]}),j=[{field:"Nombre",inNameId:"name",inType:"text"},{field:"Apellido",inNameId:"lastName",inType:"text"},{field:"Ciudad",inNameId:"city",inType:"text"},{field:"N\xFAmero De Contacto",inNameId:"phoneNumber",inType:"tel"}];const O=()=>{const{userLogged:r}=P(),{user:l}=I(),[t,f]=S.exports.useState({}),[C,b]=S.exports.useState(!1),n=l.form;let c={},s={};const U=a=>{f({...t,[a.target.name]:a.target.value})},g=()=>{for(let a in t)if(t[a]!=="")switch(a){case"name":c={...c,name:t[a]},n.role==="alumn"&&(s={...s,studentName:t[a]}),n.role==="teacher"&&(s={...s,teacherName:t[a]});break;case"lastName":c={...c,lastName:t[a]},n.role==="alumn"&&(s={...s,studentLastName:t[a]}),n.role==="teacher"&&(s={...s,teacherLastName:t[a]});break;case"city":c={...c,city:t[a]},n.role==="alumn"&&(s={...s,studentCity:t[a]}),n.role==="teacher"&&(s={...s,teacherCity:t[a]});break;case"phoneNumber":c={...c,phoneNumber:t[a]},n.role==="alumn"&&(s={...s,studentPhoneNumber:t[a]}),n.role==="teacher"&&(s={...s,teacherPhoneNumber:t[a]});break}},w=async a=>{a.preventDefault(),b(!0),g();try{const i=_(),E=m(i,`Users/${r.uid}`);await h(E,{...c});const D=async N=>{const p=m(i,`Classes/${N}`);await h(p,{...s,modification:!0})};if(n.role==="teacher"){const N=A(i,`Users/${r.uid}/myStudents`);(await T(N)).forEach(v=>{D(v.id)})}if(n.role==="alumn"&&n.teacher==="assigned"){const N=m(i,`Users/${r.uid}/myClasses/${n.myClassesId}`);await h(N,{...s});const p=m(i,`Classes/${n.myClassesId}`);await h(p,{...s});const v=m(i,`Users/${n.teacherUid}/myStudents/${r.uid}`);await h(v,{...s});const F=m(i,`Users/${r.uid}/mySchedule/${r.uid}`),$=m(i,`Users/${n.teacherUid}/mySchedule/${r.uid}`),o=(await L($)).data();for(let y in s)if(s[y]!=="")switch(y){case"studentName":for(const u in o)o[u].studentName=s[y],console.log(`${u}: ${o[u].studentName}`);break;case"studentLastName":for(const u in o)o[u].studentLastName=s[y],console.log(`${u}: ${o[u].studentLastName}`);break;default:break}await h(F,{...o}),await h($,{...o})}b(!1),swal("Muy Bien!","Actualizaci\xF3n exitosa","success")}catch(i){swal("UPS!",`${i.message}`,"error"),b(!1)}};return C?e(x,{}):d("div",{className:"editarInfo-container",children:[e("h5",{children:"EDITAR MI INFORMACION"}),e("div",{children:e("div",{children:d("form",{className:"editarInfo__form",onSubmit:w,children:[j.map((a,i)=>d("div",{children:[d("label",{htmlFor:a.inNameId,children:[a.field," :"]}),e("input",{type:a.inType,id:a.inNameId,name:a.inNameId,value:t[a.inNameId]||"",onChange:U})]},i)),e("button",{className:"editarInfo-button",type:"submit",children:"Editar"})]})})})]})};const B=()=>{const{user:r}=I();k();const[l,t]=S.exports.useState(!1),f=r.form,C=()=>{t(!l)};return f?d("div",{className:"mainProfile-container",children:[e(M,{userInfo:f,role:r.role,toggle:C}),l&&e(O,{})]}):e(x,{})};export{B as default};
